#### OTUS "**PostgreSQL для администраторов баз данных и разработчиков**" hometask lesson 1

> запустить везде psql из под пользователя postgres 
>
> выключить auto commit 
>
> сделать в первой сессии новую таблицу и наполнить ее данными create table persons(id serial, first_name text, second_name text); insert into persons(first_name, second_name) values('ivan', 'ivanov'); insert into persons(first_name, second_name) values('petr', 'petrov'); commit; 
>
> посмотреть текущий уровень изоляции: show transaction isolation level 

Текущий уровень изоляции read commited

> начать новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции 
>
> в первой сессии добавить новую запись insert into persons(first_name, second_name) values('sergey', 'sergeev'); 
>
> сделать select * from persons во второй сессии
>
> видите ли вы новую запись и если да то почему?

Нет, новой записи нет, так как в первой сессии транзакция не завершена. Запросы не могут считывать данные, которые были изменены\добавлены другими транзакциями, но еще не были зафиксированы.

> начать новые но уже repeatable read транзакции
>
> set transaction isolation level repeatable read; 
>
> в первой сессии добавить новую запись insert into persons(first_name, second_name) values('sveta', 'svetova'); 
>
> сделать select * from persons во второй сессии 
>
> видите ли вы новую запись и если да то почему?

Нет, новой записи нет. Уровень изоляции repeatable read так же как и уровень изоляции read commited не позволяет считывать изменённые\добавленные данные незавершённых транзакций.

> завершить первую транзакцию - commit; 
>
> сделать select * from persons во второй сессии 
>
> видите ли вы новую запись и если да то почему

Нет. новой записи нет. В режиме *Repeatable Read* видны только те данные, которые были зафиксированы до начала транзакции, но не видны незафиксированные данные и изменения, произведённые другими транзакциями в процессе выполнения данной транзакции.

> завершить вторую транзакцию 
>
> сделать select * from persons во второй сессии 
>
>  видите ли вы новую запись и если да то почему?

Да, новые записи видны так как стартовала новая транзакция.

> \echo :AUTOCOMMIT 
>
> \set AUTOCOMMIT OFF

\set AUTOCOMMIT ON так как автоматическое завершение транзакции уже было выключено ранее
